=================================================================
Downloading newest contracts data set from finances.worldbank.org.
=================================================================
=================================================================
Cleaning contracts data set
=================================================================
=================================================================
Resolving entities in contracts data set.
=================================================================
=================================================================
Loading contracts data set into database.
=================================================================
psql:droptable.sql:1: ERROR:  table "latest_contract_web_download_cleaned_resolved" does not exist
psql:copydata.sql:1: ERROR:  relation "latest_contract_web_download_cleaned_resolved" does not exist
=================================================================
Loading contracts data set into database.
=================================================================
=================================================================
Cleaning projects data set
=================================================================
=================================================================
Loading projects data set
=================================================================
psql:droptable.sql:1: ERROR:  table "project_data" does not exist
psql:copydata.sql:1: ERROR:  relation "project_data" does not exist
=================================================================
joining project and contract data
=================================================================
psql:droptable.sql:1: ERROR:  table "contracts_wprojects" does not exist
psql:dropcolumn.sql:1: ERROR:  relation "latest_contract_web_download_cleaned_resolved" does not exist
psql:dropcolumn.sql:1: ERROR:  relation "project_data" does not exist
psql:dropcolumn.sql:1: ERROR:  relation "project_data" does not exist
psql:dropcolumn.sql:1: ERROR:  relation "project_data" does not exist
psql:joinprojectdata.sql:1: ERROR:  relation "latest_contract_web_download_cleaned_resolved" does not exist
LINE 1: CREATE TABLE contracts_wprojects AS SELECT * FROM latest_con...
                                                          ^
=================================================================
Generating contract features
=================================================================
=================================================================
labeleing data
=================================================================
csv
Index([u'Complaint No', u'Date Complaint Opened', u'Complaint Status',
       u'Case Number', u'Lead Investigator', u'Date Case Opened', u'VPU',
       u'Country', u'Major Sector', u'Project Number', u'Project Name',
       u'Project Amount', u'Concept Review Date', u'Begin Preparation Date',
       u'Decision Meeting Date', u'Begin Appraisal Date',
       u'Bank Approval Date', u'Signing Date', u'Effectiveness Date',
       u'Approval Date', u'Closing Date', u'WB ID',
       u'Borrower Contract Number', u'Contract Name', u'Contract Amount',
       u'Supplier', u'Procurement Type Description', u'Procurement Method ID',
       u'No Objection Date', u'Contract Sign-off Date', u'CaseOutcome',
       u'SubjectName', u'Allegation Category', u'Allegation Type',
       u'Allegation OutCome'],
      dtype='object')
Index([u'Allegation Category', u'Allegation OutCome', u'Allegation Type',
       u'Approval Date', u'Bank Approval Date', u'Begin Appraisal Date',
       u'Begin Preparation Date', u'Borrower Contract Number', u'Case Number',
       u'CaseOutcome', u'Closing Date', u'Complaint No', u'Complaint Status',
       u'Concept Review Date', u'Contract Amount', u'Contract Name',
       u'Contract Sign-off Date', u'Country', u'Date Case Opened',
       u'Date Complaint Opened', u'Decision Meeting Date',
       u'Effectiveness Date', u'Lead Investigator', u'Major Sector',
       u'No Objection Date', u'Procurement Method ID',
       u'Procurement Type Description', u'Project Amount', u'Project Name',
       u'Project Number', u'Signing Date', u'SubjectName', u'Supplier', u'VPU',
       u'WB ID'],
      dtype='object')
Index([u'allegation_category', u'allegation_outcome', u'allegation_type',
       u'approval_date', u'bank_approval_date', u'begin_appraisal_date',
       u'begin_preparation_date', u'borrower_contract_number', u'case_number',
       u'caseoutcome', u'closing_date', u'complaint_no', u'complaint_status',
       u'concept_review_date', u'contract_amount', u'contract_name',
       u'contract_sign-off_date', u'country', u'date_case_opened',
       u'date_complaint_opened', u'decision_meeting_date',
       u'effectiveness_date', u'lead_investigator', u'major_sector',
       u'no_objection_date', u'procurement_method_id',
       u'procurement_type_description', u'project_amount', u'project_name',
       u'project_number', u'signing_date', u'subjectname', u'supplier', u'vpu',
       u'wb_id'],
      dtype='object')
3944
=================================================================
merging contracts, features labels
=================================================================
(151803, 48)
0         1206226
1         1206226
2         1205318
3         1205318
4         1123539
5         1123539
6         1123528
7         1123528
8         1205308
9         1205308
10        1205309
11        1205309
12        1205313
13        1205313
14        1205335
15        1205335
16        1123542
17        1123542
18        1205315
19        1205315
20        1205312
21        1205312
22        1124387
23        1124387
24        1120289
25        1120289
26        1203497
27        1203497
28        1120672
29        1120672
           ...   
151773    1524881
151774    1526315
151775    1525322
151776    1523505
151777    1517200
151778    1516275
151779    1514189
151780    1514151
151781    1517206
151782    1517921
151783    1516265
151784    1517937
151785    1516282
151786    1519961
151787    1516283
151788    1521177
151789    1518130
151790    1516394
151791    1516402
151792    1516391
151793    1519684
151794    1515681
151795    1515547
151796    1520274
151797    1515770
151798    1515255
151799    1515257
151800    1515256
151801    1515240
151802    1522040
Name: wb_contract_number, dtype: int64
(3959, 36)
Index([u'Unnamed: 0', u'allegation_category', u'allegation_outcome',
       u'allegation_type', u'approval_date', u'bank_approval_date',
       u'begin_appraisal_date', u'begin_preparation_date',
       u'borrower_contract_number', u'case_number', u'caseoutcome',
       u'closing_date', u'complaint_no', u'complaint_status',
       u'concept_review_date', u'contract_amount', u'contract_name',
       u'contract_sign-off_date', u'country', u'date_case_opened',
       u'date_complaint_opened', u'decision_meeting_date',
       u'effectiveness_date', u'lead_investigator', u'major_sector',
       u'no_objection_date', u'procurement_method_id',
       u'procurement_type_description', u'project_amount', u'project_name',
       u'project_number', u'signing_date', u'subjectname', u'supplier', u'vpu',
       u'wb_id'],
      dtype='object')
0         1206226
1         1206226
2         1205318
3         1205318
4         1123539
5         1123539
6         1123528
7         1123528
8         1205308
9         1205308
10        1205309
11        1205309
12        1205313
13        1205313
14        1205335
15        1205335
16        1123542
17        1123542
18        1205315
19        1205315
20        1205312
21        1205312
22        1124387
23        1124387
24        1120289
25        1120289
26        1203497
27        1203497
28        1120672
29        1120672
           ...   
151773    1524881
151774    1526315
151775    1525322
151776    1523505
151777    1517200
151778    1516275
151779    1514189
151780    1514151
151781    1517206
151782    1517921
151783    1516265
151784    1517937
151785    1516282
151786    1519961
151787    1516283
151788    1521177
151789    1518130
151790    1516394
151791    1516402
151792    1516391
151793    1519684
151794    1515681
151795    1515547
151796    1520274
151797    1515770
151798    1515255
151799    1515257
151800    1515256
151801    1515240
151802    1522040
Name: wb_contract_number, dtype: int64
0             0
1             0
2             0
3             1
4             1
5             1
6             1
7             1
8             2
9             2
10            2
11            2
12            3
13            3
14            3
15            3
16            4
17            4
18            4
19            4
20            5
21            5
22            5
23            5
24            6
25            6
26            6
27            6
28            7
29            7
         ...   
1275    1522049
1276    1522412
1277    1522412
1278    1522412
1279    1522556
1280    1523114
1281    1523114
1282    1523340
1283    1523340
1284    1523504
1285    1523504
1286    1523825
1287    1523825
1288    1524408
1289    1524408
1290    1524702
1291    1525795
1292    1525877
1293    1525877
1294    1525878
1295    1525878
1296    1525925
1297    1526129
1298    1526443
1299    1527263
1300    1527953
1301    1530389
1302    1530389
1303    1532380
1304    1532380
Name: wb_id, dtype: int64
(1305, 4)
(151803, 48)
(982, 52)
=================================================================
Loading labeled feature gen 1 data set
=================================================================
psql:droptable.sql:1: ERROR:  table "labeled_contracts_cleaned_resolved_feature_gen_1" does not exist
CREATE TABLE
=================================================================
generating supplier features for allegations
=================================================================
=================================================================
generating allegations ranked list
=================================================================
Index([                            u'_unnamed',
                                 u'Unnamed: 0',
                               u'Unnamed: 0.1',
                                 u'as_of_date',
                                u'fiscal_year',
                                     u'region',
                                    u'country',
                      u'borrower_country_code',
                                 u'project_id',
                               u'project_name',
                           u'procurement_type',
                       u'procurement_category',
                         u'procurement_method',
                               u'product_line',
                               u'major_sector',
                         u'wb_contract_number',
                       u'contract_description',
                      u'contract_signing_date',
                                   u'supplier',
                           u'supplier_country',
                      u'supplier_country_code',
         u'borrower_contract_reference_number',
                          u'resolved_supplier',
                         u'orig_supplier_name',
                                     u'year_x',
                                      u'month',
                  u'country_name_standardized',
                             u'Country Name_x',
                             u'Country Code_x',
                           u'Indicator Name_x',
                           u'Indicator Code_x',
                                     u'year_y',
                                        u'ppp',
                             u'Country Name_y',
                             u'Country Code_y',
                           u'Indicator Name_y',
                           u'Indicator Code_y',
                                       u'year',
                           u'currency_convert',
                                     u'amount',
                        u'amount_standardized',
                       u'project_total_amount',
                         u'project_proportion',
                        u'country_mean_amount',
       u'contract_high_rel__mean_by_year_flag',
                       u'country_total_amount',
         u'contract_proportion__total_by_year',
                                  u'objective',
                                u'competitive',
                        u'allegation_category',
                         u'allegation_outcome',
                                u'outcome_val',
                                      u'wb_id'],
      dtype='object')
cntrcts_splr_ftr_set_alleg_ctry_amt_cum_pct_dist_1years
New data:  (982, 73)
=================================================================
generating supplier features for contracts
=================================================================
Connecting to database... 0.216567993164 s elapsed
Reading data... 15.8629980087 s elapsed
(151803, 48)
(5000, 48)
dropping fiscal_year
keeping year_x year
keeping Country Name_x Country Name
keeping Country Code_x Country Code
keeping Indicator Name_x Indicator Name
keeping Indicator Code_x Indicator Code
dropping year_y
dropping Country Name_y
dropping Country Code_y
dropping Indicator Name_y
dropping Indicator Code_y
dropping contract_high_rel__mean_by_year_flag
dropping contract_proportion__total_by_year
dropping fiscal_year
keeping year_x year
keeping Country Name_x Country Name
keeping Country Code_x Country Code
keeping Indicator Name_x Indicator Name
keeping Indicator Code_x Indicator Code
dropping year_y
dropping Country Name_y
dropping Country Code_y
dropping Indicator Name_y
dropping Indicator Code_y
dropping contract_high_rel__mean_by_year_flag
dropping contract_proportion__total_by_year
151687
28510
Generating binary fields...
   rgn... 0.0590598583221 s elapsed
0.059072971344 s elapsed
Boolean fields:  7
Conditional amounts...
0.098592042923 s elapsed
Generating binary fields...
   rgn... 0.00551700592041 s elapsed
0.00553107261658 s elapsed
Boolean fields:  6
Conditional amounts...
0.0186140537262 s elapsed
Num years:  0
Running full table
Writing to database...
28510
0 (5000, 10)
1 (5000, 10)
2 (5000, 10)
3 (5000, 10)
4 (5000, 10)
5 (3510, 10)
Writing to database... 2.54204201698 s elapsed
Running SQL statement... False <sqlalchemy.engine.result.ResultProxy object at 0x7f59d53a0c90>
(5000, 19)
(5000, 25)
4.53812599182 s elapsed
Generating supplier specific counts...
   rgn...
         distribution... 2.21353793144 s elapsed
Creating anonymous ranking features...
0.0112137794495 s elapsed
(5000, 37)
(28510, 21)
Connecting to database... 0.139780044556 s elapsed
Reading data... 13.6839702129 s elapsed
(151803, 48)
(5000, 48)
dropping fiscal_year
keeping year_x year
keeping Country Name_x Country Name
keeping Country Code_x Country Code
keeping Indicator Name_x Indicator Name
keeping Indicator Code_x Indicator Code
dropping year_y
dropping Country Name_y
dropping Country Code_y
dropping Indicator Name_y
dropping Indicator Code_y
dropping contract_high_rel__mean_by_year_flag
dropping contract_proportion__total_by_year
dropping fiscal_year
keeping year_x year
keeping Country Name_x Country Name
keeping Country Code_x Country Code
keeping Indicator Name_x Indicator Name
keeping Indicator Code_x Indicator Code
dropping year_y
dropping Country Name_y
dropping Country Code_y
dropping Indicator Name_y
dropping Indicator Code_y
dropping contract_high_rel__mean_by_year_flag
dropping contract_proportion__total_by_year
151687
28510
Generating binary fields...
   rgn... 0.0458099842072 s elapsed
0.0458228588104 s elapsed
Boolean fields:  7
Conditional amounts...
0.0458278656006 s elapsed
Generating binary fields...
   rgn... 0.00588488578796 s elapsed
0.00590085983276 s elapsed
Boolean fields:  6
Conditional amounts...
0.00590586662292 s elapsed
Num years:  0
Running full table
Writing to database...
28510
0 (5000, 10)
1 (5000, 10)
2 (5000, 10)
3 (5000, 10)
4 (5000, 10)
5 (3510, 10)
Writing to database... 2.31499791145 s elapsed
Running SQL statement... False <sqlalchemy.engine.result.ResultProxy object at 0x7f5973fb5650>
(5000, 13)
(5000, 19)
3.89179992676 s elapsed
Generating supplier specific counts...
   rgn...
         distribution... 1.89752197266 s elapsed
Creating anonymous ranking features...
rgn
0.00799798965454 s elapsed
(5000, 31)
(28510, 14)
